# DS18B20Temperature_acquisition
DS18B20温度采集系统 - 使用说明
1. 系统概述
本项目是基于STM32F103RC单片机的多通道DS18B20温度采集系统，支持同时连接多达5个DS18B20温度传感器。系统采用单总线(1-Wire)通信协议与DS18B20传感器通信，支持传感器自动识别、配置和温度读取功能。系统能够自动记忆传感器位置配置，并提供学习模式用于重新配置传感器位置。
2. 硬件连接

单总线数据线：连接到PB7引脚
配置按键：连接到PB6引脚
DS18B20传感器：最多支持5个，通过单总线并联连接

注意：DS18B20需要接上拉电阻(典型值4.7kΩ)连接到VCC。
3. 系统功能
3.1 温度采集功能

支持多达5个DS18B20温度传感器同时连接(根据实际需求调整数量)
温度测量范围：-55°C ~ 125°C
温度分辨率：0.0625°C (12位精度)
自动检测传感器连接状态
温度数据通过RS485接口上传

3.2 传感器管理功能

传感器自动识别与位置记忆
学习模式支持手动关联传感器与固定位置
配置信息保存到Flash，掉电不丢失
传感器故障自动检测

4. 操作说明
4.1 正常工作模式
上电后系统默认进入正常工作模式：

1.加载Flash中保存的传感器配置信息
2.检测总线上所有传感器的连接状态
3.每秒读取一次所有传感器的温度数据
4.将有效温度数据更新到系统变量中，供RS485模块上传

4.2 学习模式
进入学习模式的两种方式：

1.启动时按住PB6按键，系统会自动进入学习模式
2.运行过程中长按PB6按键3秒以上，系统会重启并进入学习模式

学习模式操作步骤：

1.系统提示"DS18B20 LEARNING MODE"表示已进入学习模式
2.按照提示，依次连接每个位置的传感器(一次只能连接一个)
3.连接好后按下按键进行学习
4.系统会读取传感器的ROM码并测试温度读取功能
5.完成所有位置的学习后，系统会保存配置并重启进入正常模式

5. 技术细节
5.1 传感器检测与识别

使用Dallas 1-Wire协议与DS18B20通信
每个DS18B20都有唯一的64位ROM码用于识别
系统可以通过ROM码匹配特定传感器
支持CRC校验确保数据完整性

5.2 温度数据处理

有效温度范围检查：-55°C ~ 125°C
异常值过滤：超出范围的数据不更新
断线检测：自动标记失联的传感器

5.3 配置存储

使用STM32内部Flash最后一个页(0x0803F000)存储配置信息
包含魔术数字验证配置有效性
保存每个传感器的ROM码和状态信息

6. 常见问题与解决方法

1.传感器无法识别

检查物理连接和上拉电阻
确认传感器未损坏
重新进入学习模式


2.温度读数异常

检查传感器连接是否牢固
远离强电磁干扰源
更换传感器测试


3.系统无法进入学习模式

检查按键连接是否正常
确保按键长按时间足够(3秒以上)


4.配置丢失

可能是Flash写入失败，重新进行学习配置
如频繁发生，检查电源稳定性

7. 联系与支持
helsonpp@gmail.com

版本信息: v1.0
最后更新: 2025年3月3日
